<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bernd Funovits - Abstracts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Bernd Funovits</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
    <a href="http://www.github.com/bfunovits" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./academia.html">Academia</a></li><li class="breadcrumb-item"><a href="./research_abstracts.html">Abstracts</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projects_professional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Professional Projects</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./academia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Academia</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research_abstracts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Abstracts</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./research_papers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Papers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research_papers_blaschke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mirroring Roots with Blaschke Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./research_papers_gmr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comment on GMR</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cv_long.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CV</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#published" id="toc-published" class="nav-link active" data-scroll-target="#published">Published</a></li>
  <li><a href="#working-papers" id="toc-working-papers" class="nav-link" data-scroll-target="#working-papers">Working Papers</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Abstracts</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="published" class="level1">
<h1>Published</h1>
<p><strong>Identifiability and Estimation of Possibly Non-Invertible SVARMA Models: A New Parametrisation</strong></p>
<ul>
<li>single-authored</li>
<li><strong>Journal of Econometrics</strong> 2024, conditionally accepted for publication</li>
</ul>
<p>This article focuses on the parametrisation, identifiability, and (quasi-) maximum likelihood (QML) estimation of possibly non-invertible structural vector autoregressive moving average (SVARMA) models. SVAR models are routinely adopted due to their well-known implementation strategy. However, for various economic and statistical reasons, multivariate SVARMA settings are often more suitable. These settings introduce complexity in the analysis, primarily due to the presence of the moving average (MA) polynomial. We propose a novel representation of the MA polynomial matrix using the Wiener-Hopf factorization (WHF). A significant advantage of the WHF is its ability to handle possible non-invertibility and thus models with informational asymmetry between economic agents and outside observers. Since solutions of Dynamic Stochastic General Equilibrium (DSGE) models often involve this informational asymmetry, SVARMA models in WHF parametrisation can be considered data-driven alternatives to DSGE models and used for their evaluation. Furthermore, we provide low-level conditions for the asymptotic normality of the (Q)ML estimator and analytic expressions for the score and information matrix. As application, we estimate the Blanchard and Quah model and compare our results with previous literature. Importantly, we have implemented this novel method in a well-documented R-package, making it readily accessible for researchers and practitioners.</p>
<p><strong>Identifiability of Structural Singular Vector Autoregressive Models</strong></p>
<ul>
<li>joint with Alexander Braumann</li>
<li><strong>Journal of Time Series Analysis</strong> 2021, Volume 42, Issue 4, Pages 431-441</li>
<li><a href="https://onlinelibrary.wiley.com/doi/10.1111/jtsa.12576">https://onlinelibrary.wiley.com/doi/10.1111/jtsa.12576</a></li>
</ul>
<p>We generalize well-known results on structural identifiability of vector autoregressive models (VAR) to the case where the innovation covariance matrix has reduced rank. Structural singular VAR models appear, for example, as solutions of rational expectation models where the number of shocks is usually smaller than the number of endogenous variables, and as an essential building block in dynamic factor models. We show that order conditions for identifiability are misleading in the singular case and provide a rank condition for identifiability of the noise parameters. Since the Yule-Walker equations may have multiple solutions, we analyze the effect of restrictions on the system parameters on over- and underidentification in detail and provide easily verifiable conditions.</p>
<p><strong>Analysis of Indeterminate Equilibria in Linear Rational Expectations Models</strong></p>
<ul>
<li>single-authored<br>
</li>
<li>Audioslides: <a href="http://audioslides.elsevier.com//ViewerSmall.aspx?source=1&amp;doi=10.1016/j.econlet.2017.09.021">http://audioslides.elsevier.com//ViewerSmall.aspx?source=1&amp;doi=10.1016/j.econlet.2017.09.021</a></li>
<li><strong>Economics Letters</strong>, Volume 161, December 2017, Pages 47-51</li>
</ul>
<p>This note characterises the dimension of indeterminacy of linear rational expectations (LRE) models and derives their full set of solutions. It extends the analysis of indeterminate equilibria in Lubik, Schorfheide (2003) where some equilibria are incorrectly classified as indeterminate. Moreover, an example of an LRE model with a unique solution is given whose solution set would be characterised as indeterminate according to the same reference.</p>
<p><strong>Multivariate AR Systems and Mixed Frequency Data: G- Identifiability and Estimation</strong></p>
<ul>
<li>joint with Brian D.O. Anderson, Manfred Deistler, Elisabeth Felsenstein, Lukas Kölbl, Mohsen Zamani</li>
<li><strong>Econometric Theory</strong> 2016, Volume 32, Issue Number 4, Pages 793-826</li>
</ul>
<p>This paper is concerned with the problem of identifiability of the parameters of a high frequency multivariate autoregressive model from mixed frequency time series data. We demonstrate identifiability for generic parameter values using the population second moments corresponding to the observations. In addition we display a constructive algorithm for the parameter values and establish the continuity of the mapping attaching the high frequency parameters to these population second moments. These structural results are obtained using two alternative tools viz.&nbsp;extended Yule Walker equations and blocking of the the output process. The cases of stock and flow variables, as well as of general linear transformations of high frequency data are treated. Finally, we shortly discuss how our constructive identifiability results can be used for parameter estimation based on the sample second moments.</p>
<p><strong>Identifiability of regular and singular multivariate autoregressive models from mixed frequency data</strong></p>
<ul>
<li>joint with Anderson, B. D. O., Deistler, M., Felsenstein, E., Eichler, M., Chen, W., Zamani, M. &amp; Zadrozny, P.</li>
<li><strong>IEEE</strong> 51st Annual Conference on Decision and Control (CDC) 2012, page 184-189</li>
</ul>
<p>This paper is concerned with identifiability of an underlying high frequency multivariate AR system from mixed frequency observations. Such problems arise for instance in economics when some variables are observed monthly whereas others are observed quarterly. If we have identifiability, the system and noise parameters and thus all second moments of the output process can be estimated consistently from mixed frequency data. Then linear least squares methods for forecasting and interpolating nonobserved output variables can be applied. Two ways for guaranteeing generic identifiability are discussed.</p>
<p><strong>AR Systems and Processes: The Singular Case</strong></p>
<ul>
<li>joint with Manfred Deistler and Alexander Filler</li>
<li><strong>Communications in Information and Systems</strong> 2011, Volume 11, Number 3, Pages 225-236</li>
</ul>
<p>We deal with singular multivariate AR systems and the corresponding AR processes. An AR system is called singular if the variance of the white noise innovation is singular. AR processes are the stationary solutions of AR systems. In the singular case AR processes consist of a linearly regular and a linearly singular component. The corresponding Yule-Walker equations and in particular the possible non-uniqueness of their solutions are discussed. A particular canonical form is presented. Singular AR systems naturally arise as models for latent variables in dynamic factor analysis.</p>
<p><strong>PhD Thesis: Essays on Identifiability and Estimation in Multivariate Time Series Models</strong></p>
<p>This thesis is concerned with identifiability analysis and estimation of multivariate linear dynamic models. A particular emphasis is given firstly to models with strictly fewer inputs than outputs, secondly to the case of mixed frequency data, and lastly to linear multivariate rational expectations model. Chapter 2 deals with spectral factorization, i.e.&nbsp;obtaining a transfer function from the spectral density, of singular rational spectral densities. Chapter 3 deals with the identifiability problem for singular AR models, shows that the identifiability problem in this case is very similar to the one for usual multivariate ARMA models, and introduces a new canonical form. Chapter 4 deals with identifiability from mixed frequency data in the sense that we want to obtain the underlying high frequency AR model from (mixed frequency) population second moments which can be observed in principle. The case of singular and as well as the case of non-singular innovation covariance matrix is treated. The main result is that “typically” identifiability can be ensured using second moments. Chapter 5 is concerned with stochastic singularity in multivariate linear rational expectations models. It provides important preliminary work for treating identifiability analysis and estimation of structural singular ARMA models. The main result is the derivation of the number of free parameters in the reduced form of a rational expectations model in the stochastically singular case. It holds under very general restrictions on the parameter space such that state-of-the-art macroeconomic models can be analyzed. Chapter 6 extends the analysis of indeterminate equilibria of rational expectations models in (Lubik and Schorfheide, Journal of Economic Dynamics and Control, 2003). It is shown that there are certain parameter constellations that lead to models which are deemed to have an indeterminate solution according to the analysis given by Lubik and Schorfheide even though the solution is actually unique.</p>
</section>
<section id="working-papers" class="level1">
<h1>Working Papers</h1>
<p><strong>All-Pass Functions for Mirroring Pairs of Complex-Conjugated Roots of Rational Matrix Functions</strong></p>
<ul>
<li>joint with Wolfgang Scherrer</li>
<li><a href="https://arxiv.org/pdf/2010.01598">https://arxiv.org/pdf/2010.01598</a></li>
</ul>
<p>We construct rational all-pass matrix functions with real-valued coefficients for mirroring pairs of complex-conjugated determinantal roots of a rational matrix. This problem appears, for example, when proving the spectral factorization theorem, or, more recently, in the literature on possibly non- invertible or possibly non-causal vector autoregressive moving average (VARMA) models. In general, it is not obvious whether the all-pass matrix function (and as a consequence the all-pass transformed rational matrix with initally real-valued coefficients) which mirrors complex-conjugated roots at the unit circle has real-valued coefficients. Naive constructions result in all-pass functions with complex-valued coefficients which implies that the real-valued parameter space (usually relevant for estimation) is left.</p>
<p><strong>Comment on Gouriéroux, Monfort, Renne (2019): Identification and Estimation in Non-Fundamental Structural VARMA Models</strong></p>
<ul>
<li><a href="https://arxiv.org/pdf/2010.02711">https://arxiv.org/pdf/2010.02711</a></li>
</ul>
<p>This comment points out a serious flaw in the article <em>“Gouriéroux, Monfort, Renne (2019): Identification and Estimation in Non-Fundamental Structural VARMA Models”</em>, henceforth abbreviated as GMR, with regard to mirroring complex-valued roots with Blaschke polynomial matrices. Moreover, the (non-) feasibility of the proposed method (if the handling of Blaschke transformation were not prohibitive) forcross-sectional dimensions greater than two and vector moving average (VMA) polynomial matrices of degree <span class="math inline">\(q\)</span> greater than one is discussed.</p>
<p><strong>The Right Parametrization for Opening the Blackbox: A Right Matrix Fraction Description of the Common Factors in GDFMs</strong></p>
<ul>
<li>joint with Juho Koistinen</li>
</ul>
<p>We consider estimation of stochastic processes with rational spectral densities that are rank deficient. Interest in these processes has emerged in relation to generalized dynamic factor models (GDFMs), which contain fewer economic shocks than endogenous variables. Our contribution is to propose a right matrix fraction description (MFD) realization of an (Nxq)-dimensional transfer function, where <span class="math inline">\(N&gt;&gt;q\)</span>, i.e.&nbsp;<span class="math inline">\(k( z ) e_t =d( z ) c(z)^{-1} e_t\)</span> with <span class="math inline">\(d(z)\)</span> and <span class="math inline">\(c(z)\)</span> of dimensions <span class="math inline">\((N \times q)\)</span> and <span class="math inline">\((q \times q)\)</span> which has two advantages over the usual two-step estimation procedure (where firstly a static transformation reduces to a static factor process with full rank covariance matrix and secondly a VAR model with fewer inputs than outputs is estimated): Its one-step nature makes it potentially more efficient and the same dynamics might be modeled with fewer parameters. The right MFD realization allows for more generality compared to the singular VAR since the covariance of the N -dimensional common factors <span class="math inline">\(\chi_t\)</span> at lag <span class="math inline">\(0\)</span> can be of rank <span class="math inline">\(r&lt;N\)</span>. Moreover, the rank of the spectral density of the common factors is <span class="math inline">\(q&lt;r\)</span>. We analyse the properties of the column Kronecker canonical form (which can be written as a minimal state space realization), and highlight its usefulness for modeling the common factor of GDFMs. Using the state space representation of the right MFD, estimation can be performed efficiently via Kalman filtering.</p>
<p><strong>Multivariate All-Pass Time Series Models: Modelling and Estimation Strategies</strong></p>
<p>In this paper, we analyze multivariate rational all-pass filters. The poles of the determinant of all-pass matrix functions are the conjugated reciprocals of its roots. Multivariate all-pass filters are important for analyzing non-causal and non-invertible time series models as recently proposed in, e.g., Lanne and Saikkonen (2013). For i.i.d white noise input, all-pass models generate uncorrelated (white noise) processes; however, these processes are not independent in the non-Gaussian case. We propose a new estimation strategy for non-causal VAR systems.</p>
<p><strong>Stochastic Singularity and Indeterminacy in Linear Multivariate Rational Expectations Models</strong></p>
<p>This paper analyses the number of free parameters and solutions of the structural difference equation (SDE) obtained from a linear multivariate rational expectations model. It is shown that the number of free parameters depends on the structure of the zeros at zero of a certain matrix polynomial of the structural difference equation and the number of white noise shocks driving the rational expectations model. Moreover, the implications of requiring that some components of the endogenous variables be predetermined are analyzed. This makes a comparison of results on existence and uniqueness of solutions in the literature possible. Last, general restrictions on the parameters of the SDE are allowed. This analysis is the basis for identifiability analysis of determinate and indeterminate solutions of rational expectations (RE) models without assuming minimality.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>